---
title: Graph Neural Network(GNN)

categories:
  - DeepLearning
tags:
  - [DL, Graph]

toc: true
toc_sticky: true

date: 2022-12-20
last_modified_at: 2022-12-20 
---

## 1. Graph Neural Network
### 1) Graph란?

그래프의 개념은 아래 링크를 참조하면 된다.
-[Chapter 9.1 Graph(그래프)의 정의와 종류](https://meaningful96.github.io/datastructure/2-Graph/)
-[Chapter 9.2 Graph(그래프)구현](https://meaningful96.github.io/datastructure/1-Graph/)
-[Chapter 9.3 Graph(그래프) 탐색(1) BFS & DFS](https://meaningful96.github.io/datastructure/2-BFSDFS/)
-[Chapter 9.4 Graph(그래프) 탐색(2) Bidirectional Search](https://meaningful96.github.io/datastructure/3-Bidirectionalsearch/)
-[Chapter 9.5 그래프 보충(Supplemnet of Graph)](https://meaningful96.github.io/datastructure/1-graph/)

간략하게 그래프의 구조는 다음과 같이 $$G = (V,E)$$로 정의된다.

<p align="center">
<img width="500" alt="1" src="https://user-images.githubusercontent.com/111734605/208984702-642c1b33-0940-4469-a731-91dca6bfdad8.png">
</p>

- V는 Vertex(Node)들의 집합이다.
- E는 Edge들의 집합이다.

그래프는 주로 인접행렬(Adjacenct matrix)로 표현되는데, 이 크기는 노드의 개수가 n일때, $$n \times n$$이다. 또한, feature matrix로 표현하기도 하는대, feature의 개수가 $$f$$일때,
feature matrix의 차원은 $$n \times f$$이다.

**그래프를 분석하기 어려운 이유**
- 그래프는 우리가 익숙한 유클리드 공간에 있지 않다.
- 그래프는 고정된 형태가 아니다.
- 사람이 해석할 수 있도록 시각화 하는 것이 어렵다.\

**그래프를 사용하는 이유**
- <span style = "color:aqua">관계, 상호작용</span>과 같은 추상적인 개념을 다루기에 적합하다.
- 복잡한 문제를 더 간단한 표현으로 단순화하기도 하고 다른 관점으로 표현하여 해결할 수 있다.
- Social Network, 미디어의 영향, 바이러스 확산 분석 등에 아주 유용하다.

### 2) Graph Neural Network란?

**기존 그래프 분석 방법**
- 검색 알고리즘(BFS, DFS)
- 최단 경로 알고리즘(Dijkstra, A-star 알고리즘)
- 신장 트리 알고리즘(Prim 알고리즘, Kruskal 알고리즘)
- 클러스터링 방법(연결 성분, 클러스터링 계수)

Graph Neural Network는 말 그대로 Graph + 신경망, 즉 그래프에 직접 적용할 수 있는 신경망이다.   
**점 레벨, 선 레벨, 그래프 레벨**에서의 예측 작업에 쓰인다. 대표적인 세 개의 큰 개념 알고리즘이 있다.  
- Recurrent Graph Neural Network
- Spatial Convolutional Network
- Spectral Convultional Network

GNN의 핵심은 <span style = "color:aqua">노드가 이웃과의 연결에 의해 정의</span>된다는 것이다. 만약 어떤 점의 이웃과 연결을 다 끊으면 그 점은 고립되고 아무 의미를 갖지 않게 된다.
따라서 노드의 이웃과 이웃에 대한 연결이 노드의 개념을 정의한다.

이에 따라 모든 노드가 각각의 feature를 설명하는 어던 상태(state)로 표현되어 있다고 가정하면
- Output(o)를 만들기 위해 node_state(x)를 사용한다.


```
예를 들어, 점(노드)이 영화고 이 영화는 로맨스,범죄,공포 중에 로맨스, 범죄에 해당한다면 (1,1,0)의 상태를 가지고 있다고 생각할 수 있다. 
GNN은 주로 연결관계와 이웃들의 상태를 이용하여 각 점의 상태를 업데이트(학습)하고 마지막 상태를 통해 예측 업무를 수행한다. 일반적으로 
마지막 상태를 ‘node embedding’이라고 부른다.
```

즉 노드 상태(x)를 사용하여 출력(o), 즉 개념에 대한 결정을 생성 할 수 있다. 노드의 최종 상태 $$x_n$$을 일반적으로 Node Embedding이라고 한다.
<span style = "color:aqua">모든 GNN task는 인접 노드에 대한 정보를 보고 각 노드의 Node Embedding을 결정하는 것이다. </span>

<p align="center">
<img width="800" alt="1" src="https://user-images.githubusercontent.com/111734605/209777134-f3e6e9a6-13d0-438b-b2e1-bd23518c228f.png">
</p>

GNN의 기본은 그래프에 있는 <span style = "color:aqua">**노드 사이의 관계를 모델링**</span>하고, 그에 대한 <span style = "color:aqua">**Representation을 생성**</span>하는 것이다.

**Ex)**
- "SNS 사용자의 네트워크 관계가 그래프로 주어질 때 해당 유저의 영향력을 예측하기"

<p align="center">
<img width="600" alt="1" src="https://user-images.githubusercontent.com/111734605/209832158-7bdaee92-cc11-4dcd-825a-d795166f2be8.png">
</p>

이를 수행하기 위해서는 임의의 구조의 그래프 G가 들어왔을 때 그를 하나의 Representation으로 표현해야 한다. 즉, $$F(G) = embedding$$ 으로 변환할 수 있는 함수 F를 찾는 것이 목표이다.

<p align="center">
<img width="600" alt="1" src="https://user-images.githubusercontent.com/111734605/209832562-2d1f99b0-d9cb-4983-9d1b-9b29f242e91e.png">
</p>

