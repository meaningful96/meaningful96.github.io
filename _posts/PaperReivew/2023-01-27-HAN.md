---
title: Heterogeneous Graph Attention Network

categories: 
  - PaperReview
  
tags:
  - [GNN,Graph]
  
toc: true
toc_sticky: true

date: 2023-01-27
last_modified_at: 2023-01-27
---

<span style = "font-size:120%">Paper: Heterogeneous Graph Attention Network</span>

Xiao Wang, Houye Ji, Chuan Shi, Bai Wang, Peng Cui, P. Yu, Yanfang Ye (2019, WWW)

## 1. Problem Statement

<p align="center">
<img width="800" alt="1" src="https://user-images.githubusercontent.com/111734605/215000073-d1317816-6f8d-434c-904e-a34e3f1828bf.png">
</p>

<span style = "font-size:110%">1) GNN 모델들에 "Attention Mechanism"이 적용된 적이 없다.</span>

Attention Mechanism은 특히 Transformer기반 모델들을 이용하는 자연어 처리 분야나 딥러닝 분야에서는 많이 사용되고 있다. 하지만, GNN 기반의 모델들에는 적용하려는 시도 자체도 적었고, 
특히 Heterogeneous Graph 를 이용하는 분야에는 적용 사례가 없었다.

실제로 세상에 있는 많은 그래프는 Heterogeneous Graph이기 때문에 이 분야에 대한 모델 개선의 필요성이 증가하고 있다. 


<span style = "font-size:110%">2) 전통적인 GNN은 Heterogeneous Graph를 처리하는데 부적합하다.</span>

Heterogeneous Graph의 복잡성 때문에 기존의 전통적인 GNN 기반의 모델들은 직접적인 적용이 어렵다.

## 2. Related Work
- Node Embedding
- GNN
- GAN
- Attetnion Mechanism
- Heterogeneity of Graph

## 3. Method
### 1) Overview

<p align="center">
<img width="700" alt="1" src="https://user-images.githubusercontent.com/111734605/215003117-4b1a43f0-e9b9-44aa-a2dc-a6f7c048e577.png">
</p>
<center><span style = "font-size:80%">Overview of HAN Structure</span></center>

Heterogeneous Graph Attention Network(HAN) 모델의 전체적인 구조를 보면 위와 같다. HAN은 크게 두 가지 Step으로 구성되어 있다.

- Node-Level Attention
- Semantic-Level Attention

Node-Level Attention은 Heterogeneous graph의 노드들의 타입이 여러개이고 이들의 feature의 차원수가 다를 수 있으므로 차원수를 맞춰주기 위해  선형 변환을 해주고, 그런다음 노드들의 정보를 Meta-path 별로 aggregation한다.

Semantic-Level Attention은 앞서 Meta-path 별로 취합 된 정보들을 다시 하나로 aggregation. 이렇게 나온 최종 임베딩 출력값으로 Loss를 Cross-entropy로 하여 MLP를 수행하여 Prediction을 한다.

### 2)  Background - Heterogeneous Graph

<p align="center">
<img width="100%" alt="1" src="https://user-images.githubusercontent.com/111734605/215004641-0f1b56c9-8be1-4ba9-a65e-226d2ac7eb01.png ">
</p>
Heterogeneous Graph는 왼쪽 그림을 보면 이해하기 쉽다. 노드들이 총 8개로 구성된 그래프인데, 노드들의 타입(종류)이 Actor, Movie, Director로 여러 개인 것을 볼 수 있다.
