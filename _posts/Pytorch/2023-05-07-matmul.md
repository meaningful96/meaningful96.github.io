---

title: "[Pytorch] 다차원 Tensor의 곱(Matmul)"

categories: 
  - Pytorch
  
tags:
  - [DL, Pytorch]
  
toc: true
toc_sticky: true

date: 2023-05-07
last_modified_at: 2023-05-07
---

# Pytorch 텐서의 연산
## 1. Broadcasting
크기가 서로 다른 텐서끼리 연산할 때 자동으로 크기를 맞춰주는 기능이다.

### 1) 덧셈 & 뺄셈
두 행렬을 서로 더하거나 뺄 때 크기각 같아야 한다. Pytorch에서는 크기가 다르더라도 <b>브로드캐스팅(Broadcasting)</b> 통해 크기가 서로 다른 두 텐서의 연산을 가능케 해준다. 

먼저 크기가 같은 경우이다.  

```python
t1 = torch.FloatTensor([[10, 100], 
                       [1000, 10000]])
                       
t2 = torch.FloatTensor([[1, 2], 
                        [3, 4]]) # 둘다 크기가 (1, 2)인 텐서


print(t1 + t2) 
# tensor([[ 11., 102.],
#         [ 1003., 10004.]])
```

크기가 다른 경우는 Broadcasting을 한다.

```python
t1 = torch.FloatTensor([[1, 4]]) # 크기가 (1, 2)인 텐서
t2 = torch.FloatTensor([[3], [4]]) # 크기가 (2, 1)인 텐서

print(t1 + t2) # tensor([[4., 7.],
               #        [5., 8.]])

print((t1 + t2).size()) # torch.Size([2, 2])
```

<br/>

### 2) 텐서 곱(matmul)


