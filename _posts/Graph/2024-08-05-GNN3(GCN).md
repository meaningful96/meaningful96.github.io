---
title: "[그래프 이론]Graph Convolution Network(GCN)"
categories: 
  - Graph
  
toc: true
toc_sticky: true

date: 2024-08-05
last_modified_at: 2024-08-05
---

# GCN의 정의
이미지, 텍스트, 정형 데이터는 격자 형태로 표현이 가능하다. 즉, 유클리디언 공간에 함수 좌표로 표현할 수 있다(좌표 평면상에서 벡터로 표현 가능). 반면, 소셜 네트워크나 분자 데이터 등은 유클리디언 공간 상에 표현하는 것이 어렵다. 유클리디언 공간이 아니므로 거리는 중요하지 않으며 ‘<span style="color:red">**연결 여부**</span>’와 ‘<span style="color:red">**연결 강도**</span>’가 중요하다.

<p align="center">
<img width="600" alt="1" src="https://github.com/user-attachments/assets/44b2f2e8-63f0-4e95-9637-2cbf1e3326a8">
</p>

그래프 합성곱 신경망(GCN)은 비대칭 정규화를 사용하여 각 노드의 이웃 정보를 집계한다. 수식은 다음과 같다:

<center>$$h_v = f \left( \frac{1}{|\mathcal{N}(v)|} \sum_{u \in \mathcal{N}(v)} \mathbf{W} \mathbf{x}_u + b \right), \quad \forall v \in \mathcal{V}$$</center>

- Notation
  - $$\mathcal{N}(v)$$는 노드 $$v$$의 이웃 노드 집합이다.
  - $$\mathbf{W}$$는 학습 가능한 파라미터인 필터 행렬로, CNN에서 사용되는 필터와 유사한 역할을 한다.
  - $$\mathbf{x}_u$$는 노드 $$u$$의 초기 노드 특징이다.
  - $$\mathbf{b}$$는 학습 가능한 파라미터인 바이어스이다.
  - $$f$$는 비선형 활성화 함수로, 일반적으로 ReLU가 사용된다.

이 수식은 다음과 같은 구성 요소로 나뉜다:
- **정규화(Normalization)**: $$\frac{1}{\vert \mathcal{N}(v) \vert}$$
- **이웃 집계(Neighborhood Aggregation)**: $$\sum_{u \in \mathcal{N}(v)}$$
- **필터 행렬(Filter matrix)**: $$\mathbf{W}$$
- **바이어스(Bias)**: $$b$$
- **초기 노드 특징(Initial Node Features)**: $$\mathbf{x}_u$$

필터 행렬은 학습 가능한 파라미터로, 노드 특징을 변환하는 역할을 한다. 이 행렬은 CNN에서 필터와 유사한 역할을 하며, 노드 특징을 새로운 공간으로 매핑하여 임베딩을 생성한다. GCN은 결론적으로 **필터 행렬** $$\mathbf{W}$$와 **바이어스** $$b$$를 학습한다. CNN에서 사용되는 합성곱 연산은 커널을 움직여가며 커널 크기에 해당하는 정보를 한 곳으로 모으는 과정을 의미한다. 그래프에서는 타겟 노드와 연결된 이웃 정보를 <span style="color:red">**가중합 평균(Weighted Sum Average)**</span>하여 합성곱 효과를 만들어 낸다.

GCN은 이웃 노드로부터 정보를 받고 취합하는 여러 개의 레이어(layer)로 구성되어 있다. 레이어의 수가 많을수록 타겟 노드로부터 더 멀리 있는 노드들의 정보를 취합할 수 있다. 즉, 레이어의 수가 3이라면 타겟 노드로부터 3-hop 거리에 있는 노드들의 메시지까지 받을 수 있다. 위의 식은 1-hop 이웃의 정보를 취합하는 경우이며, 이를 $$k$$-hop의 정보를 받는 것으로 일반화하면 다음과 같다.

<center>$$h_v^{k+1} = f \left( \frac{1}{|\mathcal{N}(v)|} \sum_{u \in \mathcal{N}(v)} \mathbf{W}^k h_u^k + \mathbf{b}^k \right), \quad \forall v \in \mathcal{V}$$</center>
