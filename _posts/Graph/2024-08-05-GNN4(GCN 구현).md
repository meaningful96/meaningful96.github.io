---
title: "[그래프 이론]GCN 구현하기 with PyTorch"
categories: 
  - Graph
  
toc: true
toc_sticky: true

date: 2024-08-05
last_modified_at: 2024-08-05
---

# GCN 구현하기
## 1. 패키지 설치
```python
# Install required packages.
!pip install -q torch-scatter -f https://data.pyg.org/whl/torch-1.10.0+cu113.html
!pip install -q torch-sparse -f https://data.pyg.org/whl/torch-1.10.0+cu113.html
!pip install -q git+https://github.com/pyg-team/pytorch_geometric.git
```

## 2. Visualization을 위한 함수 정의
이 코드는 그래프와 임베딩을 시각화하는 두 가지 함수를 정의한 것이다. 각 함수의 목적은 다음과 같다:

1. **`visualizeGraph(G, color)` 함수**:
   - 그래프 `G`와 노드의 색상을 지정하는 `color` 매개변수를 입력으로 받는다.
   - `nx.spring_layout`을 사용하여 그래프의 레이아웃을 계산하고, `nx.draw_networkx`를 사용하여 그래프를 시각화한다.
   - 시각화된 그래프는 노드의 레이블을 표시하지 않으며, 노드의 색상은 `color` 매개변수를 기반으로 지정된 컬러맵(`Set2`)을 사용한다.

2. **`visualizeEmbedding(h, color, epoch=None, loss=None)` 함수**:
   - 임베딩 텐서 `h`, 색상을 지정하는 `color` 매개변수, 선택적인 `epoch` 및 `loss` 값을 입력으로 받는다.
   - 임베딩 텐서 `h`를 NumPy 배열로 변환하고, `plt.scatter`를 사용하여 2D 평면에 점으로 시각화한다.
   - `epoch`와 `loss` 값이 제공되면, 플롯의 x축 레이블에 해당 정보를 표시한다.
   - 시각화된 임베딩은 지정된 `Set2` 컬러맵을 사용하여 노드의 색상을 표시한다.

이 코드는 주로 그래프 데이터를 시각화하고, 신경망의 임베딩 결과를 시각화하는 데 사용된다. 시각화를 통해 그래프의 구조와 임베딩의 분포를 쉽게 이해할 수 있다.

```python
import torch
import networkx as nx
import matplotlib.pyplot as plt

def visualizeGraph(G, color):
  plt.figure(figsize=(7,7))
  plt.xticks([])
  plt.yticks([])
  nx.draw_networkx(G, pos=nx.spring_layout(G, seed=42), with_labels=False,
                   node_color=color, cmap="Set2")
  plt.show()

def visualizeEmbedding(h, color, epoch=None, loss=None):
  plt.figure(figsize=(7, 7))
  plt.xticks([])
  plt.yticks([])
  h = h.detach().cpu().numpy()
  plt.scatter(h[:, 0], h[:, 1], s=140, c=color, cmap="Set2")
  if epoch is not None and loss is not None:
    plt.xlabel(f'Epoch: {epoch}, Loss: {loss.item():.4f}', fontsize=16)
  plt.show()

```


# Reference
[Graph Convolutional Networks: Introduction to GNNs](https://mlabonne.github.io/blog/posts/2022-02-20-Graph_Convolution_Network.html)
